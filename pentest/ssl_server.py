#!/usr/bin/env python3

from http import server
import os
import ssl
import sys
import tempfile


if __name__ == "__main__":
    host = '127.0.0.1'
    port = 443
    if len(sys.argv) > 1:
        host = sys.argv[1]
    if len(sys.argv) > 2:
        port = int(sys.argv[2])
    httpd = server.HTTPServer((host, port), server.SimpleHTTPRequestHandler)

    with tempfile.NamedTemporaryFile(mode='w', delete=False) as handle:
        handle.write('''
-----BEGIN PRIVATE KEY-----
MIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQC7P9lnKZj/ejMy
LySJjsuwG8t7FCN0N99z57/FtedPXG+j/3WFXeQXuehRAsPchjbKawbzFG8hLQ3L
qVf5KUd8xibSBTnDvF98DCzf7Z6iYhD17hfdzJDxB/zYEQ7DcHJGryouqIZZ6MtI
8SKqTK7JkwTHCW1/3NL2KmrdgGq/W5w8WXJ01IBHb8Gd5kkll6/7cOQurAljcmqd
aIdsoSsRd9ni915kYRF2k6n4uIVjGXSIfr0v8S8yhRAiXop9ckAomJpP9Vq+GhTP
2dJ/X3PyFN8QTopRn6KiKDhvBeSWqxW2AfQI+F1k6mas7VdFNGH1FDZTzqlXrmmw
IM9V0mFbAgMBAAECggEADx94AoH0jmWjLuFp1QZIYx/LjlQxDNjaXjUQYvpvBRTV
G2ytZCkSG+xy2+AaS3w3fp+oPweedhJ6c8FojoIL+QLT7dBoOuvC1nTxRuCdGEZN
Ul95Y/t6lUzs2dJ+28AAKr9I693GhApuKKT5BMIOt8786spTIqmGDEWeveb6OBwd
ltn+JNqE6qQGooRv3kVCpNhYwoowQxRF74gJkpBvCxCEIMGNyG04VOXu0c7WYsa+
XxVi70y+lh7HAFCeNrzVT1uMFA/OJIirTbLvD8z4dEb64OG1q0IK9PBneM9/tpyd
PAyNTlop9EFxpQJOC0xzXm0NYaKF2fVdtR94PpUlyQKBgQDm2yQlLJ10yF9bwfbS
buBPRQCzWYXyfowIQjvqoBQsgKYNjabOTuWN6fDiq3gvkX2gLB+h1uSNMtBHkJ6t
zwlSq1nisEIL1m/9x3aAjq4GQr3snQreP6Ug2Ag2BCrynRIwCCuFJOSZO4hbwN1c
3J38O8tQchKtmInLSnC2dS02FwKBgQDPpNgBKWwc/zxyHiUIyuDtmNa+yqfpqMFi
OHLuaU3MoM0xsdqSmZG5tprDce3cusYYFM1IfQAo8iVr5WRs16nhb9rFw/r59VAK
cJrOo9acAeEGF+vclSkSpVl/GA3yHV9Aq91t1N4dImYomMdtS+H19NncB8Eij6Mo
5KOyoTf9XQKBgFurmWbJmJzPFE6zbveQ37GajPSrD+2DIsgExRYeCuTBES9AmIRE
ABOiWe0oeckp1ODNpKH3WzpWey5v1xLdq64QLNk/dHqO5Fm54uyZu7Dwv8o9chte
2ot4PYp1jThZ9ubr15w/Uicm5LbKlxxQ3stSUyHWqmQUtmLrZGaPkSxxAoGAavUA
huitVeprWmUIspS+c+TMiQ6em49fvZZSLVh0yLjzuWthqS4NkFntMkuXOKHEtFbS
v0oUMQM6H2/T4PTd/s+9Iy2mM+cWyanjNBnUzBtzq83aoo76zy35AayEUniqvgdJ
Ue/aUauMb9DyuOvjguwS5HHiHElcxA2x/KtqyckCgYBUEMmHjCPzW1MXMjik1ZTm
D8TWtZCb/J58pQhh0ZcFuFAzoglSD/5pU9SzChO5GlRpl544vppZfQgPU8dfSKxx
tBddEar3yuCiS4MewkzcpvlhJuOiZ4xp4iNDZJQMLyHlTf8V3uZ0pjehPz0Xi5y3
Wovd6o3Ipnl2QyJDIsTANw==
-----END PRIVATE KEY-----
-----BEGIN CERTIFICATE-----
MIIDoTCCAomgAwIBAgIJAOAXvwI7jfy3MA0GCSqGSIb3DQEBCwUAMGcxCzAJBgNV
BAYTAlVTMRYwFAYDVQQIDA1NYXNzYWNodXNldHRzMQ8wDQYDVQQHDAZCb3N0b24x
FjAUBgNVBAoMDUxvZ01lSW4sIEluYy4xFzAVBgNVBAMMDioubGFzdHBhc3MuY29t
MB4XDTE4MDEzMDA5MTY0M1oXDTI4MDEyODA5MTY0M1owZzELMAkGA1UEBhMCVVMx
FjAUBgNVBAgMDU1hc3NhY2h1c2V0dHMxDzANBgNVBAcMBkJvc3RvbjEWMBQGA1UE
CgwNTG9nTWVJbiwgSW5jLjEXMBUGA1UEAwwOKi5sYXN0cGFzcy5jb20wggEiMA0G
CSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC7P9lnKZj/ejMyLySJjsuwG8t7FCN0
N99z57/FtedPXG+j/3WFXeQXuehRAsPchjbKawbzFG8hLQ3LqVf5KUd8xibSBTnD
vF98DCzf7Z6iYhD17hfdzJDxB/zYEQ7DcHJGryouqIZZ6MtI8SKqTK7JkwTHCW1/
3NL2KmrdgGq/W5w8WXJ01IBHb8Gd5kkll6/7cOQurAljcmqdaIdsoSsRd9ni915k
YRF2k6n4uIVjGXSIfr0v8S8yhRAiXop9ckAomJpP9Vq+GhTP2dJ/X3PyFN8QTopR
n6KiKDhvBeSWqxW2AfQI+F1k6mas7VdFNGH1FDZTzqlXrmmwIM9V0mFbAgMBAAGj
UDBOMB0GA1UdDgQWBBTO2VTmZyamWF83SIb8oHs04qfa6zAfBgNVHSMEGDAWgBTO
2VTmZyamWF83SIb8oHs04qfa6zAMBgNVHRMEBTADAQH/MA0GCSqGSIb3DQEBCwUA
A4IBAQAEf1HEz7j4N6IzU04lK5vwRemfNLumerZS63J9mOBQaw7J1MNAs/qjJ/TM
yexiMgSE9m8FEiNrOd+pf/esRLmtpr3vBBVmBYaEGMkNodojo3QlaDe3At1yxFHM
62lBEa73gFn+04MZgjFGI7Npo8P4ji5Bf45yQFqi46nFo+ge9IZd/woV5qWcx2CL
UqJRDO+sosyRwF/+XkU6tY0IseLE1OoVlsL4XuY2+GN1CW4hEDDE/Vr5aCAjE5BQ
5/vVzdVPJigl0n5NTiRda8W5MaXUf2UJd04kqSjx19+6lZUzn29I5gBxmv7/8neL
etNd0q5Fr3GqVNgQo717nuIJsEda
-----END CERTIFICATE-----
        ''')
        handle.close()
        httpd.socket = ssl.wrap_socket(httpd.socket, certfile=handle.name, server_side=True)
        os.unlink(handle.name)
    httpd.serve_forever()
