# USAGE
# python port_scanner.py -H bernardoamc.github.io -p "80, 443"

import argparse
import nmap

def nmapScan(hosts):
    nm = nmap.PortScanner()
    nm.scan(hosts=hosts, arguments='-n -sP')

    print("Status\t\tHost\t\t\tMAC")

    for host in nm.all_hosts():
        if nm[host]['status']['state'] != "down":
            host_info = nm[host]
            try:
                print("%s\t\t%s\t\t%s" % (host_info['status']['state'], host, host_info['addresses']['mac']))
            except:
                print("%s\t\t%s\t\tUNKOWN" % (host_info['status']['state'], host))

def main():
    parser = argparse.ArgumentParser('usage %prog -r "<hosts>"')
    parser.add_argument("-r", dest="hostRange", help="specify range of hosts")

    options = parser.parse_args()
    hosts = options.hostRange

    if not hosts:
        parser.eror('[-] You must specify a target.')
        exit(0)

    nmapScan(hosts)

if __name__ == '__main__':
    main()
